<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>LPJSM for snSMART with binary outcomes (3 active treatments or placebo and two
dose level) — LPJSM_binary • snSMART</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="LPJSM for snSMART with binary outcomes (3 active treatments or placebo and two
dose level) — LPJSM_binary"><meta property="og:description" content="A joint-stage regression model (LPJSM) is a frequentist modeling approach that
incorporates the responses of both stages as repeated measurements for each subject.
Generalized estimating equations (GEE) are used to estimate the response rates of
each treatment. The marginal response rates for each DTR can also be obtained based
on the GEE results."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">snSMART</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/sidiwang/snSMART/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>LPJSM for snSMART with binary outcomes (3 active treatments or placebo and two
dose level)</h1>
    <small class="dont-index">Source: <a href="https://github.com/sidiwang/snSMART/blob/HEAD/R/JSRM_binary.R" class="external-link"><code>R/JSRM_binary.R</code></a></small>
    <div class="hidden name"><code>LPJSM_binary.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A joint-stage regression model (LPJSM) is a frequentist modeling approach that
incorporates the responses of both stages as repeated measurements for each subject.
Generalized estimating equations (GEE) are used to estimate the response rates of
each treatment. The marginal response rates for each DTR can also be obtained based
on the GEE results.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">LPJSM_binary</span><span class="op">(</span><span class="va">data</span>, six <span class="op">=</span> <span class="cn">TRUE</span>, DTR <span class="op">=</span> <span class="cn">TRUE</span>, cran_check_option <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for LPJSM_binary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for summary.LPJSM_binary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for LPJSM_binary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>dataset with columns named as <code>treatment_stageI</code>, <code>response_stageI</code>,
<code>treatment_stageII</code> and <code>response_stageII</code></p></dd>


<dt>six</dt>
<dd><p>if TRUE, will run the six beta model, if FALSE will run the two
beta model. Default is <code>six = TRUE</code></p></dd>


<dt>DTR</dt>
<dd><p>if TRUE, will also return the expected response rate and its standard
error of dynamic treatment regimens</p></dd>


<dt>cran_check_option</dt>
<dd><p>TRUE or FALSE. If FALSE, the algorithm will fit a
model like usual. This should be the default for all model fitting.
If TRUE, the model fitting is bypassed to pass CRAN check.</p></dd>


<dt>...</dt>
<dd><p>further arguments. Not currently used.</p></dd>


<dt>object</dt>
<dd><p>object to print</p></dd>


<dt>x</dt>
<dd><p>object to summarize.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a <code>list</code> containing</p>
<dl><dt><code>GEE_output</code></dt>
<dd><p>- original output of the GEE (geeglm) model</p></dd>

<dt><code>pi_hat</code></dt>
<dd><p>- estimate of response rate/treatment effect</p></dd>

<dt><code>sd_pi_hat</code></dt>
<dd><p>- standard error of the response rate</p></dd>

<dt><code>pi_DTR_hat</code></dt>
<dd><p>- expected response rate of dynamic treatment regimens (DTRs)</p></dd>

<dt><code>pi_DTR_se</code></dt>
<dd><p>- standard deviation of DTR estimates</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Wei, B., Braun, T.M., Tamura, R.N. and Kidwell, K.M., 2018. A Bayesian analysis
of small n sequential multiple assignment randomized trials (snSMARTs).
Statistics in medicine, 37(26), pp.3723-3732.</p>
<p>Chao, Y.C., Trachtman, H., Gipson, D.S., Spino, C., Braun, T.M. and Kidwell, K.M., 2020. Dynamic treatment regimens in small n, sequential, multiple assignment,
randomized trials: An application in focal segmental glomerulosclerosis. Contemporary clinical trials, 92, p.105989.</p>
<p>Fang, F., Hochstedler, K.A., Tamura, R.N., Braun, T.M. and Kidwell, K.M., 2021. Bayesian methods to compare dose levels with placebo in a small n,
sequential, multiple assignment, randomized trial. Statistics in Medicine, 40(4), pp.963-977.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="BJSM_binary.html">BJSM_binary</a></code> <br><code><a href="sample_size.html">sample_size</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data_binary</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">LPJSM_result</span> <span class="op">&lt;-</span> <span class="fu">LPJSM_binary</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, six <span class="op">=</span> <span class="cn">TRUE</span>, DTR <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">LPJSM_result</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GEE output:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> geepack::geeglm(formula = Y ~ alphaA + alphaB + alphaC + gamma1A + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     gamma2A + gamma1B + gamma2B + gamma1C + gamma2C - 1, family = poisson(link = "log"), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = geedata, id = ptid, corstr = "independence")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Estimate  Std.err     Wald Pr(&gt;|W|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alphaA   -1.2155   0.4030    9.096  0.00256 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alphaB   -0.9845   0.3403    8.370  0.00381 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alphaC   -0.8444   0.3036    7.737  0.00541 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma1A   1.2155   0.4030    9.096  0.00256 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma2A   0.7029   0.3664    3.680  0.05508 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma1B   0.9845   0.3403    8.370  0.00381 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma2B   0.8271   0.3497    5.594  0.01803 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma1C   0.8444   0.3036    7.737  0.00541 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma2C -42.2449   0.6085 4820.409  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation structure = independence </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated Scale Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std.err</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)   0.4096  0.1259</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of clusters:   30  Maximum cluster size: 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Treatment Effect Estimate:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trtA   0.2966     0.1195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trtB   0.3736     0.1271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trtC   0.4298     0.1305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Expected Response Rate of Dynamic Treatment Regimens (DTR):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rep_AB   0.8274     0.1328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rep_AC   0.9072     0.2341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rep_BA   0.7984     0.1403</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rep_BC   0.9892     0.1427</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rep_CA   0.4298     0.1305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rep_CB   0.4298     0.1305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sidi Wang, Kelley Kidwell, Michael Kleinsasser.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

